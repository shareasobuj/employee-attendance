<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Employee Attendance Pro Max</title>

<style>
body{font-family:Arial;margin:0;background:linear-gradient(135deg,#141e30,#243b55);color:#333}
.container{max-width:1100px;margin:20px auto;background:#fff;padding:20px;border-radius:14px;box-shadow:0 12px 30px rgba(0,0,0,.3)}
h1{text-align:center;color:#243b55}
.top{display:flex;gap:10px;flex-wrap:wrap;margin-bottom:15px}
input,select{padding:10px;border-radius:6px;border:1px solid #ccc;flex:1}
button{padding:10px 14px;border:none;border-radius:6px;cursor:pointer;font-weight:bold}
.add-btn{background:#28a745;color:#fff}
.present{background:#007bff;color:#fff}
.absent{background:#dc3545;color:#fff}
.delete{background:#6c757d;color:#fff}
.csv{background:#17a2b8;color:#fff}
.print{background:#ff9800;color:#fff}
.logout{background:#e91e63;color:#fff}
table{width:100%;border-collapse:collapse}
th,td{padding:10px;border-bottom:1px solid #ddd;text-align:center;font-size:14px}
.status-present{color:green;font-weight:bold}
.status-absent{color:red;font-weight:bold}
.footer{text-align:center;margin-top:15px;font-weight:bold;font-size:18px}
#authBox{max-width:400px;margin:60px auto;background:#fff;padding:25px;border-radius:12px;box-shadow:0 12px 30px rgba(0,0,0,.3)}
.hidden{display:none}
.linkBtn{background:none;border:none;color:#007bff;cursor:pointer;text-decoration:underline;margin-top:10px}
@media(max-width:700px){.top{flex-direction:column}}
</style>
</head>
<body>

<!-- AUTH BOX -->
<div id="authBox">
<h2 id="authTitle" style="text-align:center">ğŸ” User Login</h2>
<input id="email" placeholder="Email"><br><br>
<input id="password" type="password" placeholder="Password"><br><br>
<button id="authBtn" style="width:100%;background:#243b55;color:#fff" onclick="handleAuth()">Login</button>
<button class="linkBtn" onclick="toggleAuth()" id="toggleText">New user? Sign up</button>
</div>

<!-- APP -->
<div id="app" class="hidden">
<div class="container">
<h1>ğŸ‘¨â€ğŸ’¼ Employee Attendance Pro Max</h1>

<div class="top">
<input id="empName" placeholder="Employee Name">
<input id="empDept" placeholder="Department">
<input type="date" id="attDate">
<button class="add-btn" onclick="addEmployee()">â• Add</button>
<input id="search" placeholder="ğŸ” Search" onkeyup="render()">
<select id="filter" onchange="render()">
<option value="all">All</option>
<option value="Present">Present</option>
<option value="Absent">Absent</option>
</select>
<button class="csv" onclick="downloadCSV()">ğŸ“¥ CSV</button>
<button class="print" onclick="window.print()">ğŸ–¨ï¸ Print</button>
<button class="logout" onclick="logout()">ğŸšª Logout</button>
</div>

<table>
<thead>
<tr>
<th>ID</th>
<th>Name</th>
<th>Dept</th>
<th>Date</th>
<th>Check In</th>
<th>Check Out</th>
<th>Status</th>
<th>Action</th>
</tr>
</thead>
<tbody id="empList"></tbody>
</table>

<div class="footer">
Present: <span id="presentCount">0</span> |
Absent: <span id="absentCount">0</span>
</div>

</div>
</div>

<script>
// ===== USER AUTH SYSTEM =====
let isSignup=false;
let users=JSON.parse(localStorage.getItem('users'))||[];

function toggleAuth(){
  isSignup=!isSignup;
  document.getElementById('authTitle').innerText=isSignup?'ğŸ“ User Sign Up':'ğŸ” User Login';
  document.getElementById('authBtn').innerText=isSignup?'Sign Up':'Login';
  document.getElementById('toggleText').innerText=isSignup?'Already user? Login':'New user? Sign up';
}

function handleAuth(){
  const email=document.getElementById('email').value.trim();
  const pass=document.getElementById('password').value.trim();
  if(!email||!pass) return alert('Email & Password à¦¦à¦¿à¦¨');

  if(isSignup){
    if(users.find(u=>u.email===email)) return alert('User already exists');
    users.push({email,password:pass});
    localStorage.setItem('users',JSON.stringify(users));
    alert('Signup successful! Now login');
    toggleAuth();
  }else{
    const user=users.find(u=>u.email===email && u.password===pass);
    if(!user) return alert('Invalid login');
    localStorage.setItem('loggedUser',email);
    showApp();
  }
}

function logout(){localStorage.removeItem('loggedUser');location.reload()}
function showApp(){
  document.getElementById('authBox').classList.add('hidden');
  document.getElementById('app').classList.remove('hidden');
}
if(localStorage.getItem('loggedUser')) showApp();

// ===== ATTENDANCE DATA =====
let employees=JSON.parse(localStorage.getItem('employees_pro'))||[];
function save(){localStorage.setItem('employees_pro',JSON.stringify(employees))}

function addEmployee(){
 let n=document.getElementById('empName').value.trim();
 let d=document.getElementById('empDept').value.trim();
 let date=document.getElementById('attDate').value;
 if(!n||!d||!date) return alert('à¦¸à¦¬ à¦¤à¦¥à§à¦¯ à¦¦à¦¿à¦¨');
 employees.push({id:Date.now(),name:n,dept:d,date,status:'Absent',in:'--',out:'--'});
 document.getElementById('empName').value='';
 document.getElementById('empDept').value='';
 save();render();
}

function markPresent(id){let e=employees.find(x=>x.id===id);e.status='Present';e.in=new Date().toLocaleTimeString();save();render()}
function markAbsent(id){let e=employees.find(x=>x.id===id);e.status='Absent';save();render()}
function checkOut(id){let e=employees.find(x=>x.id===id);e.out=new Date().toLocaleTimeString();save();render()}
function del(id){if(confirm('Delete à¦•à¦°à¦¬à§‡à¦¨?')){employees=employees.filter(x=>x.id!==id);save();render()}}

function render(){
 let s=document.getElementById('search').value.toLowerCase();
 let f=document.getElementById('filter').value;
 let empList=document.getElementById('empList');
 empList.innerHTML='';
 let p=0,a=0;
 employees.forEach(e=>{
   if(!e.name.toLowerCase().includes(s)&&!e.dept.toLowerCase().includes(s))return;
   if(f!=='all'&&e.status!==f)return;
   if(e.status==='Present')p++;else a++;
   empList.innerHTML+=`<tr>
   <td>${e.id}</td>
   <td>${e.name}</td>
   <td>${e.dept}</td>
   <td>${e.date}</td>
   <td>${e.in}</td>
   <td>${e.out}</td>
   <td class="${e.status==='Present'?'status-present':'status-absent'}">${e.status}</td>
   <td>
     <button class="present" onclick="markPresent(${e.id})">In</button>
     <button class="absent" onclick="markAbsent(${e.id})">Absent</button>
     <button class="csv" onclick="checkOut(${e.id})">Out</button>
     <button class="delete" onclick="del(${e.id})">ğŸ—‘ï¸</button>
   </td></tr>`;
 });
 document.getElementById('presentCount').innerText=p;
 document.getElementById('absentCount').innerText=a;
}

function downloadCSV(){
 let csv='ID,Name,Department,Date,CheckIn,CheckOut,Status\n';
 employees.forEach(e=>{csv+=`${e.id},${e.name},${e.dept},${e.date},${e.in},${e.out},${e.status}\n`;});
 let blob=new Blob([csv],{type:'text/csv'});
 let a=document.createElement('a');
 a.href=URL.createObjectURL(blob);
 a.download='attendance.csv';
 a.click();
}

render();
</script>
</body>
</html>
